## CPU负载和CPU利用率的区别

可以通过uptime,w或者top命令查看CPU的平均负载。参数说明：\
load average: 负载的3个数字，表示过去1Min, 5min, 15min 内的系统平均负载。\
**负载**表示的是**当前系统正在运行的和处于等待运行的进程数之和**，也指的是可运行状态和不可中断状态的平均进程数。

如果是单核CPU,负载为1就代表满负荷了。\
如何查看CPU信息： cat /proc/cpuinfo | grep "model name"\
如何查看CPU核数： cat /proc/cpuinfo | grep "cpu cores"

**CPU利用率指的是当前正在运行的进程实时占用CPU的百分比，是对一段时间内CPU使用状况的统计。例子：厕所蹲坑\
负载：1个坑位，1个人占用，另一个人排队，则负载为2.\
利用率：1h内，这两人占用厕所的时间为30min,则；利用率为50%。

## CPU负载很高，利用率很低怎么办

这种情况说明处于等待状态的任务很多，可能有很多僵死的进程。通常这种情况是IO密集型任务，大量请求在请求相同的IO,导致任务队列堆积。

1. 先通过top命令观察是否存在高负载低利用率的情况；\
2. 通过ps -axjf查看是否存在状态为D+状态的进程，这种进程处于不可中断的睡眠状态，无法终止，也无法自行退出，只能通过恢复其依赖的资源或者重启系统来解决。

## 负载很低，利用率很高怎么办？

一个人蹲坑蹲了很久。这种情况大部分是计算密集型任务，或者代码本身有问题，生成了大量耗时短的计算任务。直接使用top命令找到使用率最高的任务，定位到对应的进程去看看，如果代码没有问题，那么
过段时间CPU使用率就会下降的。

## CPU使用率达到100%，怎么办

1.使用top命令找到占有率高的进程；\
2.通过 top -Hp pid 找到占用CPU高的线程ID, 如这里找到958的线程ID\
3.把线程ID转化为16进制： printf "0x%x\n" 958,得到线程ID 0x3be \
4.通过命令 jstack 163 | grep '0x3be' -C5 --color  或者  jstack 163|vim +/0x3be - 找到有问题的代码
